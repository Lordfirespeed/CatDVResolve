<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>CatDV Server Resolve Plugin</title>
</head>
<body>

<form>
    <h1>Import JSON</h1>
    <p id='pywebview-status'><i>pywebview</i> is not ready</p>
    <label for="json">Clips JSON:</label>
    <input type="text" id="json" name="json"><br>
</form>

<button type="button" id="add_to_media_pool" name="add_to_media_pool">Add to Resolve Media Pool</button><br>

<div id="response-container"></div>

<script>
    let webviewReady = false

    window.addEventListener("pywebviewready", function() {
        let container = document.getElementById('pywebview-status')
        container.innerHTML = '<i>pywebview</i> is ready'
        webviewReady = true
    })

    function showResponse(response) {
        let container = document.getElementById('response-container')
        container.innerText = response.message
        container.style.display = 'block'
    }

    const button = document.getElementById("add_to_media_pool")

    button.addEventListener("click", () => {
        let json_entry_text = document.getElementById("json").value

        if (!webviewReady) { return }

        pywebview.api.import_json_clips(json_entry_text).then(showResponse)
    })
</script>
</body>
</html>